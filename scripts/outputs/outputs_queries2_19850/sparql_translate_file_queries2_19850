SELECT  COUNT ( DISTINCT
     "s_37_14"."var1") AS "var2"
FROM (
    SELECT "s_37_6_t1"."S" AS "var1"
    FROM DB.DBA.RDF_QUAD AS "s_37_6_t1"
      INNER JOIN (
       SELECT "s_37_4_t0"."S" AS "var1",
           COUNT (
             "s_37_4_t0"."O") AS "var5"
        FROM DB.DBA.RDF_QUAD AS "s_37_4_t0"
        WHERE
          "s_37_4_t0"."P" = __i2idn ( __bft( 'http://www.wikidata.org/prop/direct/P40' , 1))
        GROUP BY "s_37_4_t0"."S"
OPTION (QUIETCAST)
        ) AS "s_37_5"
      ON (
        "s_37_6_t1"."S" = "s_37_5"."var1"
        AND 
        "s_37_6_t1"."O" = "s_37_5"."var5")
    WHERE
      "s_37_6_t1"."P" = __i2idn ( __bft( 'http://www.wikidata.org/prop/direct/P1971' , 1))
      AND 
      (1 - isiri_id ( "s_37_6_t1"."O"))
    UNION ALL SELECT "s_37_13_t3"."S" AS "var1"
    FROM DB.DBA.RDF_QUAD AS "s_37_13_t3"
    WHERE
      "s_37_13_t3"."P" = __i2idn ( __bft( 'http://www.wikidata.org/prop/direct/P1971' , 1))
      AND 
      "s_37_13_t3"."O" = 0
      AND 
      not ( EXISTS ( (
         SELECT TOP 1 1 AS __ask_retval
          FROM DB.DBA.RDF_QUAD AS "s_37_11_t2"
          WHERE
            "s_37_11_t2"."P" = __i2idn ( __bft( 'http://www.wikidata.org/prop/direct/P40' , 1))
            AND 
            "s_37_11_t2"."S" = "s_37_13_t3"."S"
OPTION (QUIETCAST)
         )))) AS "s_37_14"
OPTION (QUIETCAST)
